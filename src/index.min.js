/*
 0BSD
*/
(function(){function f(f){function g(a,b){if(!(this instanceof g))return new g(a,b);this.m=a;this.l=b;this.b=h();this.h=this.f()}var h=f.ArrayMap;var k=f.ArraySet;g.prototype={set:function(a,b,c){var e;null==b&&(b=null);null==c&&(c=null);var d=this.h;for(e=0;null===d.a;)d=this.c(e,a,d),e++;if(this.b.has(a))return d.a["delete"](a),d.a.add(a),this.b.set(a,b),!0;if(d.a.size<this.l)return d.a.add(a),this.b.set(a,b),!0;if(d.i)return this.o(e,d),this.set(a,b,c);"function"==typeof c&&c(Array.from(d.a));
return!1},get_all:function(){return this.g(this.h)},g:function(a){return a.a?Array.from(a.a):this.g(a.left).concat(this.g(a.right))},get_data:function(a){return this.b.get(a)||null},count:function(){return this.b.size},del:function(a){var b;if(this.b.has(a)){var c=this.h;for(b=0;null===c.a;)c=this.c(b,a,c),b++;c.a["delete"](a);this.b["delete"](a)}},closest:function(a,b){var c=this;null==b&&(b=Infinity);return Array.from(this.b.keys()).sort(function(b,d){return c.j(b,a)-c.j(d,a)}).slice(0,b)},f:function(){return{a:k(),
i:!0,left:null,right:null}},j:function(a,b){var c,e;var d=c=0;for(e=a.length;d<e;++d){var f=d;c=256*c+(a[f]^b[f])}return c},c:function(a,b,c){return b[~~(a/8)]&Math.pow(2,7-a%8)?c.right:c.left},o:function(a,b){var c=this;b.left=this.f();b.right=this.f();b.a.forEach(function(e){c.c(a,e,b).a.add(e)});b.a=null;this.c(a,this.m,b)===b.left?b.right.i=!1:b.left.i=!1}};Object.defineProperty(g.prototype,"constructor",{value:g});return g}"function"===typeof define&&define.amd?define(["array-map-set"],f):"object"===
typeof exports?module.exports=f(require("array-map-set")):this.k_bucket_sync=f(this.array_map_set)}).call(this);